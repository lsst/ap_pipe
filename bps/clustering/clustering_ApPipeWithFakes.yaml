# This is a prescription for quantum clustering with BPS, suitable for any
# concrete pipeline based on the AP pipeline. Note that there are separate
# example files for pipelines with and without fakes.
#
# Use it by adding:
#
#   includeConfigs:
#     - ${AP_PIPE_DIR}/bps/clustering/clustering_ApPipe.yaml
#
# (with no outer indentation) to your BPS config file. If you are running
# fakes, use instead:
#
#   includeConfigs:
#     - ${AP_PIPE_DIR}/bps/clustering/clustering_ApPipeWithFakes.yaml
#
# again with no outer indentation.
#

clusterAlgorithm: lsst.ctrl.bps.quantum_clustering_funcs.dimension_clustering
cluster:
  singleFrame:
    pipetasks: isr,calibrateImage,initialPviCore
    dimensions: visit,detector
    equalDimensions: visit:exposure
  diffim:
    pipetasks: retrieveTemplate,inject_visit,subtractImages,detectAndMeasure,diffimTaskCore,detectionTaskCore,filterDiaSrcCat,sampleSpatialMetrics,diffimTaskPlots,rbClassify,transformDiaSrcCat
    dimensions: visit,detector
  association:
    pipetasks: getRegionTimeFromVisit,mpSkyEphemerisQuery,loadDiaCatalogs,diaPipe
    dimensions: visit,detector
    equalDimensions: visit:group
  diaSrcDetectorAnalysis:
    pipetasks: analyzeAssocDiaSrcCore,injectedMatch,analyzeDiaFakesDetectorVisitCore,analyzeTrailedDiaSrcCore
    dimensions: visit,detector
  diaSrcVisitAnalysis:
    pipetasks: consolidateMatchDiaSrc,analyzeDiaFakesVisitCore
    dimensions: visit
